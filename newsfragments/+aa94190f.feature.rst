Update to implementation as found in Python 3.12.
